trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '16.x'
  displayName: 'Install Node.js'
  condition: 
# - task: CmdLine@2
#   inputs:
#     script: 'cd ./api'

- script: |
    yarn install
  displayName: 'yarn install'

- script: |
    yarn test
  displayName: 'yarn test'

- script: |
    npm uninstall *
  displayName: 'Clean packages'

- task: CopyFilesOverSSH@0
  inputs:
    sshEndpoint: 'EP-Server'
    contents: '**'
    targetFolder: '/api'
    readyTimeout: '20000'

